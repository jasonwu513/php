<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>HW9</title>
<style type="text/css">
*{
	font-size: 20px;
	font-family: 微軟正黑體;
}
</style>
</head>
<body>

<span>身分證檢查: </span>
<input type="text" id="inputId">
<input type="submit" id="checkBtn" value="檢查">
<div id="result"></div>

<script type="text/javascript">

function testId(inputId){
	var count = 0; //放計算值
	var checkNum; //放檢查碼
	var engNum = ["10","11","12","13","14","15","16","17","34","18","19","20","21","22","35","23","24","25","26","27","28","29","32","30","31","33"]; //A~Z代表的數字
	var idString = inputId.split(''); //輸入的身分證字串 轉成 字串陣列
	var first = idString.shift(); //移出第一個(英文字母)
	
	first = engNum[first.toUpperCase().charCodeAt(0)-65]; //第一個轉成對應數字
	idString.unshift(first.split('')[0],first.split('')[1]); //數字 轉回 字串陣列 移回去

	// console.log(idString);

	for(var i=1 ; i < 10 ; i++){
		count += (parseInt(idString[i]) * (10-i));	
		console.log(i+","+idString[i]+"="+count);
	}
	count += parseInt(idString[0]);
	// console.log(count);

	checkNum = count%10; //相加後之值除以模數10
	if(checkNum != 0){ //由模數減去餘數得檢查號碼
		if((10-checkNum) == idString[10]){
			return "身分證字號正確";
		}
		else{ 
			return "身分證字號錯誤(不符合規則)";
		}
	}
	else{ //餘數為0時，則設定其檢查碼為0
		if(checkNum ==  idString[10]){
			return "身分證字號正確";
		}
		else{
			return "身分證字號錯誤(不符合規則)";
		}
	}
}

function checkId(){
	var inputId = document.getElementById('inputId').value;
	var regExp = /^[a-zA-Z][1|2][0-9]{8}$/; //正則表示:開頭第一個A-Za-z, 第二個1or2,接下來八個0-9結束
	if(regExp.test(inputId)){
		document.getElementById('result').innerHTML = testId(inputId);
	}
	else{
		document.getElementById('result').innerHTML = "輸入格式不符,請重新確認";
	}
}

function init(){
	document.getElementById('checkBtn').onclick = checkId;
}

window.onload = init;
</script>

</body>
</html>